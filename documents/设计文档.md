# 模板话术 - 设计文档

## 1. 项目概述

一个离线Web应用，用于管理模板话术，支持变量替换、复制到剪贴板等功能。

## 2. 技术栈

- **pnpm** - 包管理器
- **TypeScript** - 类型安全
- **React 18** - UI框架
- **Vite 5** - 构建工具
- **Tailwind CSS 3** - 样式框架
- **IndexedDB** - 本地数据存储 (使用 idb 库)

## 3. 功能需求

### 3.1 主页布局
- 卡片网格布局
- PC端：每行 4 个卡片
- 移动端：每行 1 个卡片

### 3.2 卡片操作
- **编辑**：修改模板内容
- **删除**：删除模板
- **复制**：复制模板原文到剪贴板
- **生成**：根据变量生成完整话术

### 3.3 模板编辑
- 使用 `{}` 包围变量名，如 `{name}`、`{time}`
- 支持多个变量
- 变量名规则：字母、数字、下划线组合

### 3.4 话术生成
- 自动提取所有变量
- 弹出对话框让用户填写变量值
- 未填写的变量默认为空字符串
- 确认后生成完整话术并复制到剪贴板
- 显示生成成功提示

## 4. 数据结构

```typescript
interface Template {
  id: string;
  title: string;
  content: string;
  createdAt: number;
  updatedAt: number;
}

interface Variable {
  name: string;
  value: string;
}
```

## 5. 组件结构

```
src/
├── components/
│   ├── Card.tsx          # 模板卡片组件
│   ├── CardGrid.tsx      # 卡片网格布局
│   ├── AddButton.tsx     # 新增按钮
│   ├── TemplateForm.tsx  # 编辑/新增模板表单
│   ├── VariableForm.tsx  # 变量填写表单
│   └── Toast.tsx         # 提示消息
├── hooks/
│   └── useTemplates.ts   # IndexedDB 操作 Hook
├── utils/
│   └── variables.ts      # 变量提取工具函数
├── types/
│   └── index.ts          # 类型定义
├── App.tsx               # 主应用
├── main.tsx              # 入口文件
└── index.css             # 全局样式
```

## 6. 存储设计

使用 IndexedDB 存储模板数据：
- 数据库名：`template-talk-db`
- 对象仓库名：`templates`
- 索引：`id` (主键)

## 7. UI 设计

### 7.1 颜色方案
- 主色：蓝色系
- 背景：浅灰色
- 卡片：白色带阴影

### 7.2 响应式设计
```css
/* 移动端 */
.grid-cols-1

/* PC端 */
md:grid-cols-2 lg:grid-cols-4
```

## 8. 用户流程

```
1. 打开应用
   └─> 显示模板卡片列表（至少一个示例模板）

2. 点击新增按钮
   └─> 弹出编辑对话框
   └─> 输入标题和模板内容（使用{}表示变量）
   └─> 保存后添加到列表

3. 点击卡片上的操作按钮
   ├─> 编辑：弹出编辑对话框，修改后保存
   ├─> 删除：确认后从列表中移除
   ├─> 复制：直接复制模板原文到剪贴板
   └─> 生成：弹出变量填写对话框
       └─> 填写变量值
       └─> 点击确认
           └─> 生成完整话术
           └─> 复制到剪贴板
           └─> 显示成功提示
```
